(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48d1b1ac"],{"0d03":function(t,e,r){var a=r("6eeb"),s=Date.prototype,n="Invalid Date",i="toString",c=s[i],o=s.getTime;new Date(NaN)+""!=n&&a(s,i,(function(){var t=o.call(this);return t===t?c.call(this):n}))},"25f0":function(t,e,r){"use strict";var a=r("6eeb"),s=r("825a"),n=r("d039"),i=r("ad6d"),c="toString",o=RegExp.prototype,u=o[c],l=n((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),g=u.name!=c;(l||g)&&a(RegExp.prototype,c,(function(){var t=s(this),e=String(t.source),r=t.flags,a=String(void 0===r&&t instanceof RegExp&&!("flags"in o)?i.call(t):r);return"/"+e+"/"+a}),{unsafe:!0})},"446e":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("RestaurantsNavPills",{attrs:{categories:t.categories}}),t.isLoading?r("Spinner"):[r("div",{staticClass:"row"},t._l(t.restaurants,(function(t){return r("RestaurantsCard",{key:t.id,attrs:{restaurant:t}})})),1),t.restaurants.length?r("RestaurantsPagination",{attrs:{"category-id":t.categoryId,"current-page":t.currentPage,"total-page":t.totalPage}}):t._e(),t.restaurants.length?t._e():r("div",[t._v(" 沒有符合條件的餐廳。 ")])]],2)},s=[],n=(r("d3b7"),r("96cf"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-md-6 col-lg-4"},[r("div",{staticClass:"card mb-4"},[r("router-link",{staticClass:"link-img",attrs:{to:{name:"restaurant",params:{id:t.restaurant.id}}}},[r("img",{staticClass:"card-img-top",attrs:{src:t.restaurant.image,alt:"Card image cap",width:"286px",height:"180px"}})]),r("div",{staticClass:"card-body"},[r("p",{staticClass:"card-text title-wrap"},[r("router-link",{attrs:{to:{name:"restaurant",params:{id:t.restaurant.id}}}},[t._v(" "+t._s(t.restaurant.name)+" ")])],1),r("span",{staticClass:"badge badge-secondary"},[t._v(" "+t._s(t.restaurant.Category&&t.restaurant.Category.name)+" ")]),r("p",{staticClass:"card-text text-truncate"},[t._v(" "+t._s(t.restaurant.description)+" ")])]),r("div",{staticClass:"card-footer"},[t.restaurant.isFavorited?r("button",{staticClass:"btn btn-danger btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),t.deleteFavorite(t.restaurant.id)}}},[t._v(" 移除最愛 ")]):r("button",{staticClass:"btn btn-primary btn-border favorite mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),t.addFavorite(t.restaurant.id)}}},[t._v(" 加到最愛 ")]),t.restaurant.isLiked?r("button",{staticClass:"btn btn-danger like mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),t.deleteLike(t.restaurant.id)}}},[t._v(" Unlike ")]):r("button",{staticClass:"btn btn-primary like mr-2",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(e){return e.preventDefault(),t.addLike(t.restaurant.id)}}},[t._v(" Like ")])])],1)])}),i=[],c=r("4cce"),o=r("2fa3"),u={props:{restaurant:{type:Object,required:!0}},data:function(){return{isProcessing:!1}},methods:{addFavorite:function(t){var e,r;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!this.isProcessing){a.next=3;break}return a.abrupt("return",!1);case 3:return this.isProcessing=!0,a.next=6,regeneratorRuntime.awrap(c["a"].addFavorite(t));case 6:if(e=a.sent,r=e.data,"success"===r.status){a.next=10;break}throw"serverError";case 10:this.restaurant.isFavorited=!0,this.isProcessing=!1,o["a"].fire("成功加入最愛","","success"),a.next=19;break;case 15:a.prev=15,a.t0=a["catch"](0),this.isProcessing=!1,o["a"].fire({icon:"error",title:"無法加入最愛，請稍後再試"});case 19:case"end":return a.stop()}}),null,this,[[0,15]])},deleteFavorite:function(t){var e,r;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!this.isProcessing){a.next=3;break}return a.abrupt("return",!1);case 3:return this.isProcessing=!0,a.next=6,regeneratorRuntime.awrap(c["a"].deleteFavorite(t));case 6:if(e=a.sent,r=e.data,"success"===r.status){a.next=10;break}throw"serverError";case 10:this.restaurant.isFavorited=!1,this.isProcessing=!1,o["a"].fire("成功移除最愛","","success"),a.next=19;break;case 15:a.prev=15,a.t0=a["catch"](0),this.isProcessing=!1,o["a"].fire({icon:"error",title:"無法取消最愛，請稍後再試"});case 19:case"end":return a.stop()}}),null,this,[[0,15]])},addLike:function(t){var e,r;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!this.isProcessing){a.next=3;break}return a.abrupt("return",!1);case 3:return this.isProcessing=!0,a.next=6,regeneratorRuntime.awrap(c["a"].addLike(t));case 6:if(e=a.sent,r=e.data,"success"===r.status){a.next=10;break}throw"serverError";case 10:this.restaurant.isLiked=!0,this.isProcessing=!1,o["a"].fire("成功加入喜歡","","success"),a.next=19;break;case 15:a.prev=15,a.t0=a["catch"](0),this.isProcessing=!1,o["a"].fire({icon:"error",title:"無法加入喜歡，請稍後再試"});case 19:case"end":return a.stop()}}),null,this,[[0,15]])},deleteLike:function(t){var e,r;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!this.isProcessing){a.next=3;break}return a.abrupt("return",!1);case 3:return this.isProcessing=!0,a.next=6,regeneratorRuntime.awrap(c["a"].deleteLike(t));case 6:if(e=a.sent,r=e.data,"success"===r.status){a.next=10;break}throw"serverError";case 10:this.restaurant.isLiked=!1,this.isProcessing=!1,o["a"].fire("成功取消喜歡","","success"),a.next=19;break;case 15:a.prev=15,a.t0=a["catch"](0),this.isProcessing=!1,o["a"].fire({icon:"error",title:"無法取消喜歡，請稍後再試"});case 19:case"end":return a.stop()}}),null,this,[[0,15]])}}},l=u,g=(r("ff28"),r("2877")),d=Object(g["a"])(l,n,i,!1,null,"0e8bec32",null),p=d.exports,f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"nav nav-pills mb-4"},[r("li",{staticClass:"nav-item"},[r("router-link",{directives:[{name:"show",rawName:"v-show",value:t.categories.length,expression:"categories.length"}],staticClass:"nav-link",attrs:{to:{path:"/restaurants"}}},[t._v(" 全部 ")])],1),t._l(t.categories,(function(e){return r("li",{key:e.id,staticClass:"nav-item"},[r("router-link",{staticClass:"nav-link",attrs:{to:{path:"/restaurants",query:{categoryId:e.id}}}},[t._v(" "+t._s(e.name)+" ")])],1)}))],2)},v=[],h={props:{categories:{type:Array,required:!0}}},b=h,m=(r("572a"),Object(g["a"])(b,f,v,!1,null,"06a069cc",null)),y=m.exports,P=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{attrs:{"aria-label":"Page navigation example"}},[r("ul",{staticClass:"pagination"},[r("li",{directives:[{name:"show",rawName:"v-show",value:t.previousPage,expression:"previousPage"}],staticClass:"page-item"},[r("router-link",{staticClass:"page-link",attrs:{to:{path:"restaurants",query:{categoryId:t.categoryId,page:t.previousPage}}}},[r("span",[t._v("«")])])],1),t._l(t.totalPage,(function(e){return r("li",{key:e,class:["page-item",{active:t.currentPage===e}]},[r("router-link",{staticClass:"page-link",attrs:{to:{name:"restaurants",query:{categoryId:t.categoryId,page:e}}}},[t._v(" "+t._s(e)+" ")])],1)})),r("li",{directives:[{name:"show",rawName:"v-show",value:t.nextPage,expression:"nextPage"}],staticClass:"page-item"},[r("router-link",{staticClass:"page-link",attrs:{to:{path:"restaurants",query:{categoryId:t.categoryId,page:t.nextPage}}}},[r("span",[t._v("»")])])],1)],2)])},k=[],x=(r("a9e3"),{props:{categoryId:{type:[Number,String],default:""},currentPage:{type:Number,default:1},totalPage:{type:Number,default:-1}},computed:{previousPage:function(){return 1===this.currentPage?null:this.currentPage-1},nextPage:function(){return this.currentPage===this.totalPage?null:this.currentPage+1}}}),w=x,I=Object(g["a"])(w,P,k,!1,null,null,null),_=I.exports,C=r("2375"),R=r("c4c3"),N={components:{RestaurantsCard:p,RestaurantsNavPills:y,RestaurantsPagination:_,Spinner:C["a"]},data:function(){return{restaurants:[],categories:[],categoryId:0,currentPage:1,totalPage:0,isLoading:!0}},created:function(){var t=this.$route.query,e=t.page,r=t.categoryId;this.fetchRestaurants({page:e,categoryId:r})},beforeRouteUpdate:function(t,e,r){this.isLoading=!0;var a=t.query,s=a.page,n=a.categoryId;this.fetchRestaurants({page:s,categoryId:n}),r()},methods:{fetchRestaurants:function(t){var e,r,a,s,n,i;return regeneratorRuntime.async((function(c){while(1)switch(c.prev=c.next){case 0:return e=t.page,r=void 0===e?1:e,a=t.categoryId,s=void 0===a?"":a,c.prev=1,c.next=4,regeneratorRuntime.awrap(R["a"].getRestaurants({page:r,categoryId:s}));case 4:n=c.sent,i=n.data,this.restaurants=i.restaurants,this.categories=i.categories,this.categoryId=i.categoryId,this.currentPage=i.page,this.totalPage=i.totalPage.length,this.isLoading=!1,c.next=18;break;case 14:c.prev=14,c.t0=c["catch"](1),this.isLoading=!1,o["a"].fire({icon:"error",title:"無法取得餐廳資料，請稍後再試"});case 18:case"end":return c.stop()}}),null,this,[[1,14]])}}},E=N,L=Object(g["a"])(E,a,s,!1,null,null,null);e["default"]=L.exports},"572a":function(t,e,r){"use strict";var a=r("c71f"),s=r.n(a);s.a},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,r){var a=r("1d80"),s=r("5899"),n="["+s+"]",i=RegExp("^"+n+n+"*"),c=RegExp(n+n+"*$"),o=function(t){return function(e){var r=String(a(e));return 1&t&&(r=r.replace(i,"")),2&t&&(r=r.replace(c,"")),r}};t.exports={start:o(1),end:o(2),trim:o(3)}},7156:function(t,e,r){var a=r("861d"),s=r("d2bb");t.exports=function(t,e,r){var n,i;return s&&"function"==typeof(n=e.constructor)&&n!==r&&a(i=n.prototype)&&i!==r.prototype&&s(t,i),t}},a9e3:function(t,e,r){"use strict";var a=r("83ab"),s=r("da84"),n=r("94ca"),i=r("6eeb"),c=r("5135"),o=r("c6b6"),u=r("7156"),l=r("c04e"),g=r("d039"),d=r("7c73"),p=r("241c").f,f=r("06cf").f,v=r("9bf2").f,h=r("58a8").trim,b="Number",m=s[b],y=m.prototype,P=o(d(y))==b,k=function(t){var e,r,a,s,n,i,c,o,u=l(t,!1);if("string"==typeof u&&u.length>2)if(u=h(u),e=u.charCodeAt(0),43===e||45===e){if(r=u.charCodeAt(2),88===r||120===r)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:a=2,s=49;break;case 79:case 111:a=8,s=55;break;default:return+u}for(n=u.slice(2),i=n.length,c=0;c<i;c++)if(o=n.charCodeAt(c),o<48||o>s)return NaN;return parseInt(n,a)}return+u};if(n(b,!m(" 0o1")||!m("0b1")||m("+0x1"))){for(var x,w=function(t){var e=arguments.length<1?0:t,r=this;return r instanceof w&&(P?g((function(){y.valueOf.call(r)})):o(r)!=b)?u(new m(k(e)),r,w):k(e)},I=a?p(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;I.length>_;_++)c(m,x=I[_])&&!c(w,x)&&v(w,x,f(m,x));w.prototype=y,y.constructor=w,i(s,b,w)}},ad6d:function(t,e,r){"use strict";var a=r("825a");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},c4c3:function(t,e,r){"use strict";r("0d03"),r("d3b7"),r("25f0"),r("3ca3"),r("ddb0"),r("2b3d");var a=r("2fa3");e["a"]={getRestaurants:function(t){var e=t.page,r=t.categoryId,s=new URLSearchParams({page:e,categoryId:r});return a["b"].get("/restaurants?".concat(s.toString()))},getRestaurant:function(t){return a["b"].get("/restaurants/".concat(t))},getFeeds:function(){return a["b"].get("/restaurants/feeds")},getTopRestaurants:function(){return a["b"].get("/restaurants/top")}}},c71f:function(t,e,r){},fde2:function(t,e,r){},ff28:function(t,e,r){"use strict";var a=r("fde2"),s=r.n(a);s.a}}]);
//# sourceMappingURL=chunk-48d1b1ac.fecc0c83.js.map