(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-75c96511"],{a884:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.isLoading?r("Spinner"):[r("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"name"}},[e._v("Name")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"form-control",attrs:{type:"text",id:"name",name:"name",placeholder:"Enter name",required:""},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}})]),r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"image"}},[e._v("Image")]),e.user.image?r("img",{staticClass:"d-block img-thumbnail mb-3",attrs:{src:e.user.image,width:"200",height:"200"}}):e._e(),r("input",{staticClass:"form-control-file",attrs:{type:"file",id:"image",name:"image",accept:"image/*"},on:{change:e.handleFileChange}})]),r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.isProcessing}},[e._v(" Submit ")]),r("button",{staticClass:"btn btn-primary ml-3",attrs:{type:"button"},on:{click:function(t){return e.$router.back()}}},[e._v(" 回上頁 ")])])]],2)},s=[],a=(r("a4d3"),r("4de4"),r("4160"),r("b0c0"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("3ca3"),r("159b"),r("ddb0"),r("2b3d"),r("96cf"),r("2fa7")),i=r("2375"),c=r("4cce"),o=r("2fa3"),u=r("2f62");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){Object(a["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h={components:{Spinner:i["a"]},data:function(){return{user:{},isLoading:!0,isProcessing:!1}},computed:m({},Object(u["b"])(["currentUser"])),created:function(){var e=+this.$route.params.id;this.checkUser(e),this.fetchUser(e)},beforeRouteUpdate:function(e,t,r){this.isLoading=!0;var n=e.params.id;this.checkUser(n),this.fetchUser(n),r()},methods:{checkUser:function(e){this.currentUser.id!==+e&&(this.$session.flash.set("editResult",{icon:"warning",title:"沒有操作權限"}),this.$router.push("/users/".concat(e)))},fetchUser:function(e){var t,r,n;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,regeneratorRuntime.awrap(c["a"].getOne(e));case 3:t=s.sent,r=t.data,n=r.profile,this.user={id:e,name:n.name,image:n.image},this.isLoading=!1,s.next=14;break;case 10:s.prev=10,s.t0=s["catch"](0),this.isLoading=!1,o["a"].fire({icon:"error",title:"無法取得使用者，請稍後再試"});case 14:case"end":return s.stop()}}),null,this,[[0,10]])},handleFileChange:function(e){var t=e.target.files;if(!t.length)return!1;var r=window.URL.createObjectURL(t[0]);this.user.image=r},handleSubmit:function(e){var t,r,n,s,a;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:if(i.prev=0,!this.isProcessing){i.next=3;break}return i.abrupt("return",!1);case 3:return this.isProcessing=!0,t=e.target,r=new FormData(t),n=this.user.id,i.next=9,regeneratorRuntime.awrap(c["a"].update(n,r));case 9:if(s=i.sent,a=s.data,"success"===a.status){i.next=13;break}throw{msg:a.message};case 13:this.$store.commit("updateUser",{name:this.user.name,image:this.user.image}),this.isProcessing=!1,this.$session.flash.set("editResult",{icon:"success",title:"成功更新使用者資料"}),this.$router.push("/users/".concat(n)),i.next=23;break;case 19:i.prev=19,i.t0=i["catch"](0),this.isProcessing=!1,o["a"].fire({icon:"error",title:i.t0.msg||"無法更新使用者資料，請稍後再試"});case 23:case"end":return i.stop()}}),null,this,[[0,19]])}}},p=h,f=r("2877"),b=Object(f["a"])(p,n,s,!1,null,null,null);t["default"]=b.exports},b0c0:function(e,t,r){var n=r("83ab"),s=r("9bf2").f,a=Function.prototype,i=a.toString,c=/^\s*function ([^ (]*)/,o="name";!n||o in a||s(a,o,{configurable:!0,get:function(){try{return i.call(this).match(c)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-75c96511.bfec3fe7.js.map